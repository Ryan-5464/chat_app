<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="/static/styles/base/base.css">
    <link rel="stylesheet" href="/static/styles/base/button-elem.css">
    <link rel="stylesheet" href="/static/styles/base/input-elem.css">
    <link rel="stylesheet" href="/static/styles/base/modal-elem.css">
    <link rel="stylesheet" href="/static/styles/chat/base.css">
    <link rel="stylesheet" href="/static/styles/chat/chat.css">
    <link rel="stylesheet" href="/static/styles/chat/contact.css">
    <link rel="stylesheet" href="/static/styles/chat/left-sidebar.css">
    <link rel="stylesheet" href="/static/styles/chat/main-content.css">
    <link rel="stylesheet" href="/static/styles/chat/right-sidebar.css">
    <link rel="stylesheet" href="/static/styles/chat/message.css">
    <link rel="stylesheet" href="/static/styles/chat/sidebar-elem.css">
    <!-- <script src="https://unpkg.com/htmx.org@1.9.2"></script> -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&display=swap" rel="stylesheet">
  <title>Chat Window</title>
</head>

<body class="jura">

<div id="header-container">
    <nav></nav>
</div>

<div id="main-container">

    <div id="left-sidebar">

        <div id="siderbar-container">

            <div id="chats-header">
                <div id="new-chat-input-container">
                    <input id="chat-name-input" class="input-elem" type="text" placeholder="Type chat name..." />
                    <button id="new-chat-button" class="button-elem" >+</button>
                </div>
            </div>

            <div id="chats-container">
                {{ range .Chats }}
                    <div class="chat sidebar-elem" data-chatid="{{ .Id }}" data-adminid="{{ .AdminId }}" data-createdat="{{ .CreatedAt }}">
                        <div class="chat-header">
                            <div id="chat-name" class="chat-name">{{ .Name }}</div>
                            <div class="chat-admin-name">Admin Name{{ .AdminName }}</div>
                            <div class="chat-unread-message-count">
                                {{ .UnreadMessageCount }}
                            </div>
                        </div>
                    </div>
                {{ end }}
            </div>

            <div id="chatModal" class="modal">
                <div id="chatModal-content" class="modal-content">
                    <div id="chat-modal-options" class="modal-options">
                    <button id="edit-btn" class="modal-button">Edit</button>
                    <button id="leave-btn" class="modal-button">Leave</button>
                    <button id="members-btn" class="modal-button">Members</button>
                    </div>
                </div>
            </div>

        </div>

    </div>
    
    <div id="content-container">

        <div id="messages-container">

            {{ range .Messages }}
                <div class="message {{ if eq .UserId $.UserId }}me{{ end }}" data-userid="{{ .UserId }}" data-chatid="{{ .ChatId }}" data-messageid="{{ .Id }}" data-replyid="{{ .ReplyId }}">
                    <div class="message-author">{{ .Author }}</div>
                    <div class="message-createdat">{{ .CreatedAt }}</div>
                    <div class="message-lasteditat">{{ .LastEditAt }}</div>
                    <div class="message-text">{{ .Text }}</div>
                </div>
            {{ end }}

        </div>

        <div id="messageModal" class="modal">
        <div id="messageModal-content" class="modal-content">
            <div id="message-modal-options" class="modal-options">
            <button id="edit-btn" class="modal-button">Edit</button>
            <button id="delete-btn" class="modal-button">Delete</button>
            <button id="reply-btn" class="modal-button">Reply</button>
            </div>
        </div>
        </div>

        <div id="message-input-container">
            <input id="input" class="input-elem" type="text" placeholder="Type your message..." />
            <button id="send-message-button" class="button-elem">Send</button> 
        </div>

    </div>

    <div id="right-sidebar">

        <div id="right-siderbar-container">

            <div id="contact-list-header">

            <div id="add-contact-input-container">
                <input id="contact-email-input" class="input-elem" type="text" placeholder="Type contact email..." />
                <button id="add-contact-button" class="button-elem">+</button>
            </div>

            </div>

            <div id="contact-list-container">
                {{ range .Contacts }}
                    <div class="contact sidebar-elem" data-contactid="{{ .Id }}" data-contactchatid="{{ .ContactChatId }}">
                        <div class="contact-name">{{ .Name }}</div>
                        <div class="contact-email">{{ .Email }}</div>
                        <div class="contact-since">{{ .KnownSince }}</div>
                        <div class="contact-status">{{ .OnlineStatus }}</div>
                    </div>
                {{ end }}
            </div>

            <div id="contactModal" class="modal">
                <div id="contactModal-content" class="modal-content">
                    <div id="contactModal-options" class="modal-options">
                    <button id="profile-btn" class="modal-button">Profile</button>
                    <button id="remove-btn" class="modal-button">Remove</button>
                    </div>
                </div>
            </div>
        </div>


    </div>

</div>


<div id="footer-container"></div>

</body>
<script>
  const serverData = {
    user: {{ toJSON .UserId }},
    chats: {{ toJSON .Chats }},
    messages: {{ toJSON .Messages }},
    contacts: {{ toJSON .Contacts }}
  };
  console.log("Server data:", serverData);
</script>
<script src="/static/scripts/config.js" defer></script>
<script src="/static/scripts/chat.js" defer></script>
<script src="/static/scripts/modals.js" defer></script>

